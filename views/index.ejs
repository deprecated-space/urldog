<!DOCTYPE html>
<html>
<head>
  <title>查找链接</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"/>
  <link href="//cdn.bootcss.com/bootstrap-material-design/4.0.2/bootstrap-material-design.min.css" rel="stylesheet">
  <script src="//cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
  <script src="//cdn.bootcss.com/list.js/1.5.0/list.min.js"></script>
  <link rel='stylesheet' href='/stylesheets/style.css' />
</head>
<body>
<div class="container">
  <div class="row">
    <div class="col-md-12">
      <div id="link-wrapper">
        <h1 class="title">输入关键字查找</h1>
        <div class="form-group">
          <input type="text" class="form-control fuzzy-search" id="title" placeholder="title">
        </div>
        <table class="table table-striped table-sm">
          <thead>
            <tr>
              <th>Title</th>
              <th>Url</th>
            </tr>
          </thead>
          <tbody class="list">
            <% for (var i = 0; i < links.length; i++) { %>
              <tr _id="<%=links[i]['_id']%>">
                <td class="title"><%=links[i]['title']%></td>
                <td class="url"><a href="<%=links[i]['url']%>"><%=links[i]['url']%></a></td>
                <td><button type="button" class="btn btn-outline-danger btn-sm del-btn">删除</button></td>
              </tr>
            <%}%>
          </tbody>
        </table> 
      </div>
    </div>
  </div>
</div>
<script>
  new List('link-wrapper', { 
    valueNames: ['title', 'url']
  })

  $('.del-btn').click(function() {
    let _id = $(this).parent().parent().attr('_id')
    // console.log(_id)
    $.post('/link/del', {
      _id
    }, res => {
      location.reload()
    })
  })
</script>
</body>
</html>